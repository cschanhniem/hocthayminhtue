{% macro renderTree(node, activeId) %}
  <li class="tree-node {% if node.id === activeId %}active{% endif %} {% if node.id !== 'root' %}collapsed{% endif %}">
    <div class="node-content">
      {% if node.children and node.children.length > 0 %}
        <button class="toggle" aria-label="Toggle {{ node.label }}">
          <span class="icon">+</span>
        </button>
      {% else %}
        <span class="leaf-spacer w-6"></span>
      {% endif %}
      
      <a href="/concepts/{{ node.id }}/" class="node-label">{{ node.label }}</a>
    </div>
    
    {% if node.children and node.children.length > 0 %}
      <ul class="tree-children">
        {% for child in node.children %}
          {{ renderTree(child, activeId) }}
        {% endfor %}
      </ul>
    {% endif %}
  </li>
{% endmacro %}

<ul class="tree-root list-none p-0 m-0">
  {{ renderTree(concepts.root, activeId) }}
</ul>

<style>
.tree-node summary::-webkit-details-marker {
    display: none;
}

.tree-node summary::before {
    content: 'â–º';
    display: inline-block;
    margin-right: 5px;
    transform: rotate(0);
    transition: transform 0.2s;
}

.tree-node details[open] > summary::before {
    transform: rotate(90deg);
}

.tree-node a {
    text-decoration: none;
}

.tree-node a:hover {
    text-decoration: underline;
}
</style>
